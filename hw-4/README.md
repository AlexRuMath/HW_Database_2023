# Домашнее задание №4

## Содержание

---
1. [История развития СУБД](#История развития СУБД)
2. [Инструменты для взаимодействия с InfluxDB](#Инструменты для взаимодействия с InfluxDB)
3. [Database Engine](#Database Engine)
4. [Язык запросов](#Язык запросов)
5. [Возможно ли распределение файлов БД](#Возможно ли распределение файлов БД)
6. [На каких ЯП был написан InfluxDB](#На каких ЯП был написан InfluxDB)
7. [Типы индексов](#Типы индексов)
8. [Построение запросов](#Построение запросов)
9. [«План запросов»](#«План запросов»)
10. [Транзакции в InfluxDB](#Транзакции в InfluxDB)
11. [Методы восстановления](#Методы восстановления)
12. [Шардинг в InfluxDB](#Шардинг в InfluxDB)
13. [Data Mining,Data Warehousing и OLAP в InfluxDB](#Data Mining,Data Warehousing и OLAP в InfluxDB)
14. [Методы защиты](#Методы защиты)
15. [Развитие InfluxDB](#Развитие InfluxDB)

## История развития СУБД

---
InfluxDB — это высокопроизводительная база данных временных рядов, которая была разработана в 2013 году. Эта база данных была создана командой InfluxData, которая вышла на рынок с инновационными идеями, которые помогли им стать одним из ведущих поставщиков баз данных временных рядов в мире.

Идея создания InfluxDB возникла из необходимости использования баз данных временных рядов для хранения и анализа данных из множества источников. В то время, когда появилась InfluxDB, другие базы данных не могли обрабатывать большие объемы данных, что было необходимо для обработки данных временных рядов.

В начале своего развития InfluxDB была ориентирована на использование в системах мониторинга, таких как Nagios и Zabbix, где требовалась высокая скорость записи и чтения данных. Однако, со временем InfluxDB стала применяться и в других областях, таких как интернет вещей (IoT), машинное обучение, метеорология и многие другие.

За время своего существования InfluxDB сильно изменилась. Она стала более масштабируемой, более надежной и более гибкой. Сейчас InfluxDB может обрабатывать миллионы записей данных в секунду, что позволяет использовать ее для обработки данных больших объемов.

Одним из ключевых моментов в истории InfluxDB было выпуск версии 2.0 в 2020 году. Эта версия включает в себя множество новых функций и улучшений, которые делают InfluxDB еще более гибкой и мощной базой данных временных рядов.

Среди новых функций можно отметить поддержку SQL-запросов, интеграцию с кластеризацией Kubernetes, улучшенную безопасность, а также функцию Flux для обработки данных. Эти улучшения сделали InfluxDB еще более привлекательной для различных организаций и индустрий.

Сегодня InfluxDB является одной из самых популярных баз данных временных рядов в мире. Она используется во многих организациях, включая такие компании, как Cisco, IBM, Siemens и многие другие. Ее гибкость, высокая производительность и возможность обработки больших объемов данных делают ее одним из лучших выборов для хранения и анализа данных временных рядов.


## Инструменты для взаимодействия с InfluxDB

---
Ниже перечислены несколько инструментов, которые могут быть полезными при работе с InfluxDB:
1. **InfluxDB CLI (Command Line Interface)** - это инструмент командной строки, который позволяет взаимодействовать с базой данных, создавать и удалять базы данных, измерения и поля, а также выполнять запросы на чтение и запись данных. CLI также позволяет работать с конфигурационными файлами, управлять пользователями и просматривать журналы системы.
2. **InfluxDB Studio** — это веб-приложение, которое предоставляет пользовательский интерфейс для работы с базой данных. Оно позволяет создавать и удалять базы данных, измерения и поля, а также выполнять запросы на чтение и запись данных. Studio также предоставляет инструменты для визуализации данных в виде графиков и диаграмм.
3. **InfluxDB Python Client** - это библиотека Python, которая позволяет взаимодействовать с базой данных InfluxDB. Она предоставляет API для создания и удаления баз данных, измерений и полей, а также для выполнения запросов на чтение и запись данных. Python Client также предоставляет инструменты для работы с временными рядами и агрегацией данных.
4. **Grafana** - это инструмент для визуализации данных, который может использоваться с базой данных InfluxDB. Он позволяет создавать графики и диаграммы на основе данных из базы данных, а также настраивать алерты и уведомления. Grafana также предоставляет инструменты для работы с панелями и дашбордами.
5. **Telegraf** - это агент сбора данных, который может использоваться для сбора данных из различных источников и отправки их в базу данных InfluxDB. Он поддерживает множество протоколов и форматов данных, таких как SNMP, JMX, HTTP, JSON и т.д. Telegraf также предоставляет инструменты для фильтрации и преобразования данных перед отправкой в базу данных.


## Database Engine

---
InfluxDB использует собственную data engine, называемую Time-Structured Merge Tree (TSM Tree). 
Принцип работы TSM Tree заключается в том, что данные хранятся в виде файлов, называемых TSM файлами. Каждый TSM файл содержит отсортированные данные временных рядов, что позволяет быстро находить данные по времени. Кроме того, в каждом TSM файле данные сжимаются и индексируются, что ускоряет поиск.
Сравнение с другими data engine:
1. **SQL databases** (например, MySQL, PostgreSQL): InfluxDB предназначен для работы с данными временных рядов, в то время как SQL базы данных предназначены для общего назначения. InfluxDB имеет более быстрый доступ к данным временных рядов и более эффективно хранит данные благодаря своей специальной data engine.
2. **NoSQL databases** (например, MongoDB, Cassandra): InfluxDB и NoSQL базы данных используют различные модели данных. InfluxDB предназначен для хранения и обработки данных временных рядов, в то время как NoSQL базы данных могут хранить различные типы данных. 
3. **Time-series databases** (например, OpenTSDB, Graphite): InfluxDB имеет более широкий спектр функций и более эффективно хранит данные благодаря своей специальной data engine. 

В целом, InfluxDB является мощной и эффективной базой данных для хранения и обработки данных временных рядов. Его специальная data engine и простой язык запросов делают его одним из лучших выборов для работы с временными рядами.


## Язык запросов

---
InfluxDB использует свой собственный язык запросов, называемый InfluxQL (Influx Query Language). InfluxQL поддерживает операции выборки, фильтрации, группировки, агрегации, сортировки и преобразования данных. Он также предоставляет функции для работы с временными рядами, такие как среднее значение, минимальное и максимальное значение, сумма и т.д. Кроме того, InfluxDB также поддерживает Flux - новый язык запросов, основанный на функциональном программировании.
Вот несколько примеров запросов на языке Flux, используемом в InfluxDB:
1. Выбрать все данные из таблицы " coindesk " за последние 10 минут:
```
from(bucket: "SandBox")
  |> range(start: -10m)
  |> filter(fn: (r) => r._measurement == "coindesk")
  |> yield() 
```
Вывод:
 ![img_3.png](img/img_3.png)
2. Выбрать записи у которых сумма сделки выше или равно 30000:
```
from(bucket: "SandBox")
  |> range(start: -1y)
  |> filter(fn: (r) => r._measurement == "coindesk")
  |> filter(fn: (r) => r._value >= 30000)
  |> yield() 
```
Вывод:
 ![img_2.png](img/img_2.png)
3. Вернуть среднее значение сделок с EUR из таблицы coindesk:
```
from(bucket: "SandBox")
  |> range(start: -1y)
  |> filter(fn: (r) => r._measurement == "coindesk")
  |> filter(fn: (r) => r.code == "EUR")
  |> mean() 
```
 Вывод:
![img_4.png](img/img_4.png)

Это только небольшой список возможных запросов на Flux. Flux предоставляет мощные функции для работы с данными временных рядов, такие как преобразование, агрегация, группировка, фильтрация и т.д.


## Возможно ли распределение файлов БД

---
Кластерное решение не является открытым. За масштабирование и отказоустойчивость необходимо платить, приобретая лицензию. Соответственно, внедрение InfluxDB в критически важные места информационных систем невозможно.

Для достижения горизонтального масштабирования в InfluxDB Community Edition потребуется ручное создание костылей, например, установка нескольких копий InfluxDB на разных серверах или виртуальных машинах, использование репликации данных и настройка load balancer для распределения запросов между узлами. Эти шаги могут быть достаточно сложными и требовательными к ресурсам, поэтому использование InfluxDB Enterprise или InfluxDB Cloud может быть более удобным и эффективным решением для горизонтального масштабирования.

Если брать платное решение, то оно основано на использовании [Kubernetes](https://www.influxdata.com/blog/scaling-kubernetes-deployments-influxdb-flux/).


## На каких ЯП был написан InfluxDB

---
InfluxDB был написан на языке программирования Go. Go - это открытый язык программирования, разработанный Google в 2007 году для упрощения разработки эффективных и надежных программ. Это позволило избавиться от ненужных зависимостей и ускорить deploy InfluxDB в инфроструктуру.

## Типы индексов

---
Индексы InfluxDB состоят из двух типов: индекса временных меток (time index) и индекса тегов (tag index). Индекс временных меток используется для быстрого доступа к данным в заданном временном диапазоне, а индекс тегов используется для быстрого доступа к данным по значениям тегов. 

Индекс временных меток хранит информацию о времени каждой записи и используется для быстрого поиска записей в заданном временном диапазоне. Индекс временных меток обеспечивает быстрый доступ к данным, даже если в базе данных большое количество записей.

Индекс тегов хранит информацию о значениях тегов и используется для быстрого доступа к данным по значениям тегов. Индекс тегов позволяет быстро находить данные по значениям тегов, что облегчает анализ данных.

Для обеспечения эффективности индексирования InfluxDB использует структуры данных, такие как B-деревья и хеш-таблицы. Эти структуры данных обеспечивают быстрый доступ к данным и эффективное использование памяти.


## Построение запросов

---
В InfluxDB можно посылать запросы следующими способами:

1. **Data Explorer**
2. **InfluxDB API**
3. **InfluxDB CLI**
4. **Flux REPL**

## План запросов

---

InfluxDB не поддерживает план запросов

## Транзакции в InfluxDB

---
InfluxDB не поддерживает полноценных транзакций в традиционном понимании, так как она не является реляционной базой данных. Однако, InfluxDB поддерживает атомарные операции записи данных, то есть запись данных в базу происходит целиком или не происходит вообще. Если запись данных в базу прошла успешно, то она гарантированно сохранена в базе и будет доступна для чтения.

## Методы восстановления

---
InfluxDB предоставляет несколько методов восстановления данных:
1. Восстановление из резервной копии (backup): InfluxDB может создавать резервные копии базы данных с помощью команды influxd backup. Для восстановления данных из резервной копии необходимо выполнить команду influxd restore.
2. Восстановление из WAL-файлов: InfluxDB сохраняет все данные, которые были записаны в базу данных, в журнале WAL (Write-Ahead Log). Если база данных повреждена, вы можете восстановить ее из WAL-файлов. Для этого нужно выполнить команду influx_inspect export для экспорта данных из WAL-файлов и затем импортировать их обратно в базу данных.
3. Восстановление из snapshot-файлов: InfluxDB также может создавать снимки базы данных с помощью команды influxd backup. Снимки сохраняются в формате TSM (Time-Structured Merge Tree) и могут быть использованы для восстановления данных. Для восстановления нужно выполнить команду influxd restore с указанием пути к snapshot-файлу.
4. Восстановление из реплики: Если у вас есть реплика базы данных, то вы можете использовать ее для восстановления данных. Для этого нужно настроить реплику на чтение (read-only) и выполнить операцию экспорта данных с помощью команды influx_inspect export. Затем вы можете импортировать данные из экспортированного файла в поврежденную базу данных. 


## Шардинг в InfluxDB

---
InfluxDB поддерживает шардинг данных на несколько способов:
1. Шардинг по временному интервалу (time-based sharding): InfluxDB может автоматически шардировать данные на основе временного интервала. При этом данные разделяются по временным отрезкам (например, каждый месяц) и сохраняются в отдельных шардах. Этот метод позволяет распределить нагрузку на несколько узлов и обеспечить более эффективное использование ресурсов.
2. Шардинг по тегам (tag-based sharding): InfluxDB также поддерживает шардинг данных на основе тегов. При этом данные разделяются на отдельные шарды на основе значений тегов. Например, если вы имеете данные по датчикам в разных городах, можно использовать шардинг на основе тега "city" и разделить данные на отдельные шарды для каждого города.
3. Шардинг по базам данных (database sharding): Этот метод позволяет создавать отдельные базы данных и распределять данные между ними. Например, если вы имеете данные по разным клиентам, можно создать отдельную базу данных для каждого клиента и распределить данные между ними.


## Data Mining,Data Warehousing и OLAP в InfluxDB

---
InfluxDB не является полноценной системой хранения данных для построения Data Warehouse, но может использоваться для определенных сценариев.

Если вы хотите использовать InfluxDB для построения хранилища данных для анализа больших объемов данных, то вам может потребоваться интегрировать InfluxDB с другими инструментами. Например, вы можете использовать InfluxDB для сбора и хранения данных, а затем передавать эти данные в инструменты анализа данных, такие как Apache Spark, Apache Flink или Apache Beam.



## Методы защиты

---
InfluxDB обеспечивает несколько методов защиты данных и доступа к ним:
1. **Аутентификация и авторизация**: InfluxDB поддерживает аутентификацию и авторизацию для управления доступом к данным и функциям базы данных. Пользователи могут быть созданы с уникальными учетными данными и правами доступа к базе данных.
2. **Шифрование данных**: InfluxDB поддерживает шифрование данных в покое и в движении. Для шифрования в покое InfluxDB использует шифрование AES-256. Для шифрования в движении InfluxDB поддерживает SSL/TLS.
3. **Ограничение доступа к сети**: InfluxDB может быть настроен для ограничения доступа к сети с помощью брандмауэра и других методов защиты сети.
4. **Журналирование событий**: InfluxDB выполняет журналирование событий, таких как попытки входа в систему или изменения данных. Это позволяет администраторам быстро обнаруживать и реагировать на любые нежелательные действия.
5. **Кластеризация**: InfluxDB поддерживает кластеризацию, что обеспечивает более высокую доступность и надежность данных. Кластеризация также позволяет распределить нагрузку на несколько узлов, что улучшает производительность.
6. **Резервное копирование и восстановление**: InfluxDB обеспечивает возможность резервного копирования и восстановления данных, что предотвращает потерю данных в случае сбоев или аварийных ситуаций.


## Развитие InfluxDB

---